allprojects  {
  apply plugin: 'maven'

  group = 'com.neuri.dbfit'
  version = '2.0.0-RC3'
}

subprojects {
  apply plugin: 'java'

  sourceCompatibility = 1.6
  targetCompatibility = 1.6
  repositories {
    mavenRepo url: "http://repo1.maven.org/maven2"
    mavenRepo url: "http://repo.maven.apache.org/maven2"
    ivy {
        artifactPattern "https://cleancoder.ci.cloudbees.com/job/fitnesse/278/artifact/dist/[artifact].[ext]"
    }
    ivy {
        artifactPattern "https://s3.amazonaws.com/dbfit/[artifact]-[revision].[ext]"
    	ivyPattern "https://aws.amazon.com/s3/ivy.xml"
    }
  }

  dependencies {
    compile 'com.dbdeploy:dbdeploy-ant:3.0M3'
    testCompile 'junit:junit:4.10'
  }
  
  dbdeploy = { dbDriver, url, userid, password ->
    ant.taskdef(name: 'dbdeploy', 
                classname: 'com.dbdeploy.AntTarget', 
                classpath: configurations.compile.asPath)
    ant.dbdeploy(driver: dbDriver, 
      url: url,
      userid: userid, 
      password: password, 
      dir: "$projectDir/src/test/resources",
    )
  }
}

